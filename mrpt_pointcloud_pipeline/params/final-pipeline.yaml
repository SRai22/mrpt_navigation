# -----------------------------------------------------------------------------
#                         mp2p_icp filters definition file
#
# See docs for MP2P_ICP library: https://docs.mola-slam.org/mp2p_icp/
# -----------------------------------------------------------------------------

# Remove points that are too far:
- class_name: mp2p_icp_filters::FilterBoundingBox
  params:
    input_pointcloud_layer: 'raw'
    inside_pointcloud_layer: 'layer1'
    bounding_box_min: [ -20.0, -20.0,  0.1 ]
    bounding_box_max: [  20.0,  20.0,  1.5 ]

# Split into nearby and distant
- class_name: mp2p_icp_filters::FilterBoundingBox
  params:
    input_pointcloud_layer: 'layer1'
    inside_pointcloud_layer: 'close'
    outside_pointcloud_layer: 'far'
    bounding_box_min: [ -6.0, -6.0, -3.0 ]
    bounding_box_max: [  6.0,  6.0,  3.0 ]
    
# Downsample points:
- class_name: mp2p_icp_filters::FilterDecimateVoxels
  params:
    input_pointcloud_layer: 'close'
    output_pointcloud_layer: 'output'
    voxel_filter_resolution: 0.10  # [m]
    #use_voxel_average: true
    # This option flattens the 3D point cloud into a 2D one:
    flatten_to: 1.0 # [m]

- class_name: mp2p_icp_filters::FilterDecimateVoxels
  params:
    input_pointcloud_layer: 'far'
    output_pointcloud_layer: 'output'
    voxel_filter_resolution: 0.5  # [m]
    #use_voxel_average: true
    # This option flattens the 3D point cloud into a 2D one:
    flatten_to: 1.0 # [m]
